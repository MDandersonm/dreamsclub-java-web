<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xyz.dreams.mapper.GoodsMapper">

	<!-- 굿즈 메인 페이지 -->
	<!-- 굿즈 리스트 출력 -->
	<select id="selectGoodsList" resultType="GoodsDTO">
		select GOODS_CODE, GOODS_PRICE, GOODS_INFO, GOODS_YN, GOODS_STOCK, GOODS_IMAGE from goods
		<if test="q != null and q != ''"> 
			<bind name="search" value="'%'+q+'%'"/>
			where REPLACE(GOODS_CODE,' ', '') like #{search} 
		</if>
		<if test="column == 'goods_code'"> 
			order by goods_code
		</if>
		<if test="column == 'goods_price'"> 
			order by goods_price, goods_code
		</if>
	</select>

	<!-- 굿즈 디테일 페이지 -->
	<!-- 굿즈 상세 정보 출력 -->
	<select id="selectGoodsDetailList" resultType="GoodsDTO">
		select GOODS_CODE, GOODS_PRICE, GOODS_INFO, GOODS_YN, GOODS_STOCK, GOODS_IMAGE from goods
		<bind name="goodsName" value="'%%'+goodsName+'-%%'"/>
		where GOODS_CODE like <![CDATA[#{goodsName}]]> order by GOODS_CODE
	</select>
	
	<!-- 관리자 페이지 굿즈 관리 -->
	<!-- 관리자 굿즈 목록 출력 -->
	<select id="selectAdminGoodsList" resultType="GoodsDTO">
		SELECT GOODS_CODE, GOODS_PRICE, GOODS_INFO, GOODS_YN, GOODS_STOCK from goods order by GOODS_CODE
	</select>
	
	<!-- 관리자 굿즈 등록 -->
	<insert id="insertAdminGoods">
		INSERT INTO GOODS VALUES(
			#{goodsCode},
			#{goodsPrice},
			#{goodsInfo},
			#{goodsYn},
			#{goodsStock},
			#{goodsImage}
		)
	</insert>
	
	<!-- 
	방용환(생성) : 2023/09/11, 관리자 굿즈 수정 기능
	admin_goods.jsp에서 입력한 수정 값을 받아와 해당 굿즈 정보 UPDATE
	 -->
	 <update id="updateAdminGoods">
	 	UPDATE GOODS SET
	 		GOODS_PRICE = #{goodsPrice},
	 		GOODS_INFO = #{goodsInfo},
	 		GOODS_STOCK = #{goodsStock}
	 	WHERE GOODS_CODE = #{goodsCode}
	 </update>
	
</mapper>